<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta content='IE=edge' http-equiv=X-UA-Compatible> <meta content='' name=description> <meta content='width=device-width, initial-scale=1' name=viewport> <title>Andrew Eick</title> <link href="/stylesheets/application-d3a7d694.css" media=all rel=stylesheet /> <script src="/javascripts/application-d4c229b7.js" data-turbolinks-track=true></script> <link href='/images/favicon.ico' rel=icon> <link href='/images/apple-touch-icon-57-6b01ec75.png' rel=apple-touch-icon-precomposed> <link href='/images/apple-touch-icon-72-948b1079.png' rel=apple-touch-icon-precomposed sizes=72x72> <link href='/images/apple-touch-icon-114-a4711075.png' rel=apple-touch-icon-precomposed sizes=114x114> <link href='/images/apple-touch-icon-144-420d9fca.png' rel=apple-touch-icon-precomposed sizes=144x144> </head> <body class='family family_page family_page_676 family_page_676_index'> <header class=site-header role=navigation> <div class=top-bar> <a class=container href="/"><img class="logo svg" alt="" src="/images/header-logo-72c4cdf5.svg"/> <h1>Andrew Eick</h1> <p>Head in the clouds, feet in the dirt.</p> </a> </div> <nav> <ul class=left-nav> <li class=nav-home> <a class=ss-home href="/"> <span>Home</span> </a> </li> </ul> <ul> <li> <a class="ss-openbook active" href="/family"><span>Family</span> </a> </li> <li> <a class=ss-write href="/snapshot"><span>Snapshot</span> </a> </li> <li> <a class=ss-globe href="/history"><span>History</span> </a> </li> <li> <a class=ss-camera href="/portfolio"><span>Portfolio</span> </a> </li> <li> <a class=ss-send href="/contact"><span>Contact</span> </a> </li> <li> <a class=ss-user href="/about"><span>About</span> </a> </li> </ul> </nav> </header> <div class=content> <section> <ul class=list-simple> <li> <article> <div class=title> <time>June 29th, 2007</time> <h2><a href="/family/2007-06-29-pretty-print-rss-with-asp-net-v2/">Pretty Print RSS with ASP.Net v2</a></h2> </div> <p><em>RSS is the lingua franca of the web…</em></p> <p>We've been using RSS as our communication protocol with good luck.  Using a straight <em>Publisher / Subscriber</em> model we are able to get pretty rich functionality with pretty low effort spent thinking about communication protocols.  </p> <p>The problem is <em>debugging</em> with RSS.  I'm stepping through my code, and want to check the values in an RSS response from the remote server, so I pop open a browser, and type in the URL.  I get:</p> <p><img alt="" src="//media.eick.us/2011/05/633753877_f70f8c0ea4.jpg"/></p> <p>Not very helpful when I'm trying to find the guid's so I can debug the server code – I end up right click, view source….</p> <p> </p> <p>To help debugging, I wrote a quick Xml2Html.ashx to grab the RSS feed from the remote server, and then "pretty print" the RSS with a XSL style sheet to render a readable output.  Google to find a good XML-&gt;HTML style sheet.  </p> <p>To do the transformation, four lines are all that is needed:</p> <div class=csharpcode><pre><span class="lnum">   1:  </span>XslCompiledTransform trans = <span class="kwrd">new</span> XslCompiledTransform();</pre><pre><span class="lnum">   2:  </span>System.IO.Stream xslStyleSheet = </pre><pre>           System.Reflection.Assembly.GetExecutingAssembly().GetManifestResourceStream(<span class="str">"helpers.Xml2Html.xslt"</span>);</pre><pre><span class="lnum">   3:  </span>trans.Load(XmlReader.Create(xslStyleSheet));</pre><pre><span class="lnum">   4:  </span>trans.Transform(Url, <span class="kwrd">null</span>, context.Response.OutputStream);</pre><pre> </pre> In order to minimize dependencies, I embed the XSL stylesheet into the project. To embed a resource, just change the 'build action' in VS2005 to embed:   ![](http://media.eick.us/2011/05/662275247_150e866c43_o.png) To pull out the stylesheet, use the Reflection namespace (line 2 in the code sample), and create a stream into the XslTransform object. Now, whenever I need to debug the RSS feed, I just call Xml2Html.asxh?url=....   <div class=wlWriterSmartContent style="padding-right: 0px;padding-left: 0px;padding-bottom: 0px;margin: 0px;padding-top: 0px">Technorati tags: [XML](http://technorati.com/tags/XML), [XSL](http://technorati.com/tags/XSL), [RSS](http://technorati.com/tags/RSS), [ASP.net 2](http://technorati.com/tags/ASP.net%202), [C#](http://technorati.com/tags/C#)</div></div> <p>.csharpcode, .csharpcode pre{font-size: small;color: black;font-family: consolas, "Courier New", courier, monospace;background-color: #ffffff;/<em>white-space: pre;</em>/}.csharpcode pre { margin: 0em; }.csharpcode .rem { color: #008000; }.csharpcode .kwrd { color: #0000ff; }.csharpcode .str { color: #006080; }.csharpcode .op { color: #0000c0; }.csharpcode .preproc { color: #cc6633; }.csharpcode .asp { background-color: #ffff00; }.csharpcode .html { color: #800000; }.csharpcode .attr { color: #ff0000; }.csharpcode .alt{background-color: #f4f4f4;width: 100%;margin: 0em;}.csharpcode .lnum { color: #606060; }</p> </article> </li> <li> <article> <div class=title> <time>June 26th, 2007</time> <h2><a href="/family/2007-06-26-4269277/">My Outsourced Life</a></h2> </div> <p>Link: <a href="//www.timferriss.com/ferriss-book-outsourcing.htm">My Outsourced Life</a></p> </article> </li> </ul> </section> <ul class=pagination> <li class=prev> <a class=ss-navigateleft href="/family/page/675/">Prev</a> </li> <li class=next> <a class="ss-navigateright right" href="/family/page/677/">Next</a> </li> </ul> </div> <footer class=site-footer> <div class=container> <nav> <h3 class=section-title>Andy Eick</h3> <ul> <li><a href="/">Home</a></li> <li><a href="/about">About</a></li> <li><a href="/contact">Contact</a></li> <li><a href="//missionfocus.com">My Company</a></li> <li><a href="//imintel.org">My Institute</a></li> </ul> </nav> <nav> <h3 class=section-title>Blogs</h3> <ul> <li><a href="/family">Family</a></li> <li><a href="/snapshot">Snapshot</a></li> <li><a href="/history">History</a></li> </ul> </nav> <nav> <h3 class=section-title>Pages</h3> <ul> <li><a href="/portfolio">Portfolio</a></li> <li><a href="/bookshelf/index.html">Bookshelf</a></li> <li><a href="//soccer-peeps.com">Jasmine's Soccer</a></li> <li><a href="//eick-home.us.quickconnect.to/photo">Photo Archive</a></li> </ul> </nav> <div class=copyright> <p>&copy; 1999-2014</p> </div> </div> </footer> </body> </html>